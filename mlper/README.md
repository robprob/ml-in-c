# MLper (`mlper.c`)

**Machine Learning Helper**, affectionately named **MLper**, is a C library that provides algorithm-agnostic helper functions for a variety of machine learning applications. It simplifies tasks like data loading, preprocessing, and performance evaluation, making it easier to implement machine learning algorithms in C.

The library supports both **static** and **shared** compilation, with both options generated by default.

---
## **Features**
- **Dynamic Memory Management**: Automates the allocation and deallocation of memory for machine learning datasets.
- **Data Preprocessing**: Includes functions for standardizing data and splitting datasets into training and test sets.
- **Performance Metrics**: Computes evaluation metrics like Mean Squared Error (MSE).
- **CSV Utilities**: Handles loading data from CSV files and exporting results to CSV.

---
## **Functions**

### **initialize_dataset**
- **Description**: Allocates dynamic memory for feature and target variable arrays.
- **Prototype**:
  ```c
  void initialize_dataset(struct Dataset *data, int num_features, int num_entries)
  ```

### **free_dataset**
- **Description**: Frees memory dynamically allocated for dataset.
- **Prototype**:
  ```c
  void free_dataset(struct Dataset *data);
  ```

### **load**
- **Description**: Loads a CSV file into feature (X) and target (y) arrays.
- **Prototype**:
  ```c
  void load(struct Dataset *data);
  ```

### **standardize**
- **Description**: Standardize feature data to mean of 0, standard deviation of 1, using training data statistics.
- **Prototype**:
  ```c
  void standardize(struct Dataset *data);
  ```

### **unstandardize**
- **Description**: Un-standardize specified feature data matrix back to original values.
- **Prototype**:
  ```c
  void unstandardize(struct Dataset *data, double *feature_data, int num_entries);
  ```

### **train_test_split**
- **Description**: Splits data into training and test sets based on a given test proportion.
- **Prototype**:
  ```c
  void train_test_split(struct Dataset *data, double test_proportion);
  ```

### **shuffle_batch**
- **Description**: Shuffle random entries to "generate" a training batch of specified size.
- **Prototype**:
  ```c
  void shuffle_batch(struct Dataset *data, int batch_size);
  ```

### **mean_squared_error**
- **Description**: Computes the Mean Squared Error (MSE) between predicted and actual values.
- **Prototype**:
  ```c
  double mean_squared_error(double *y_actual, double *y_pred, int num_predictions);
  ```

### **export_predictions**
- **Description**: Exports predictions to a CSV file.
- **Prototype**:
  ```c
  void export_predictions(double *y_pred, int num_predictions, char *file_name);
  ```

### **export_results**
- **Description**: Exports full data, actual values, and predictions to a CSV file.
- **Prototype**:
  ```c
  void export_results(struct Dataset *data, int num_predictions, char *file_name);
  ```
---
## **How to Clone/Install**
   ```bash
   // Clone repo and move to mlper directory
   git clone https://github.com/robprob/ml-in-c.git
   cd ml-in-c/mlper

   // Compile using Makefile (requires a C compiler)
   make

   // Optional Installation
   make install
   ```



